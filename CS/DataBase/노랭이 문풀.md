59pg.
#45
```SQL
-- A U B
SELECT A.ID, B.ID
FROM TBL1 A FULL OUTER JOIN TBL2 B
ON A.ID = B.ID

-- A U B
SELECT A.ID, B.ID
FROM TBL1 A LEFT OUTER JOIN TBL2 B
ON A.ID = B.ID

UNION

SELECT A.ID, B.ID
FROM TBL1 A RIGHT OUTER JOIN TBL2 B
ON A.ID = B.ID

-- (A ∩ B) + (A - B) + (B - A)
SELECT A.ID, B.ID
FROM TBL1 A, TBL2 B
WHERE A.ID = B.ID

UNION ALL

SELECT A.ID, NULL
FROM TBL1 A
WHERE NOT EXISTS (
	SELECT 1
	FROM TBL2 B
	WHERE A.ID = B.ID
)

UNION ALL

SELECT NULL, B.ID
FROM TBL2 B
WHERE NOT EXISTS (
	SELECT 1
	FROM TBL1 A
	WHERE B.ID = A.ID
)

```

60pg
#47
DEPT, EMP를 join하되 사원이 없는 부서 정보도 같이 출력

```SQL
SELECT E.ENAME, D.DEPTNO, D.DNAME
FROM DEPT D ? EMP E
ON D.DEPTNO = E.DEPTNO
```

#48
```SQL
SELECT 8
FROM TAB1 A LEFT OUTER JOIN TAB2 B
ON (A.C1 = B.C1 AND B.C2 BETWEEN 1 AND 3)
```

pg 62.
#49
```SQL
SELECT A.게시판ID, A.게시판명, COUNT(B.게시글ID) AS CNT
FROM 게시판 A, 게시글 B
WHERE A.게시판ID = B.게시판ID(+)
AND B.삭제여부(+) = 'N'
AND A.사용여부 = 'Y'
GROUP BY A.게시판ID, A.게시판명
ORDER BY A.게시판ID;
```

pg 63.
#50
<table>
  <tr>
    <th>COL1</th>
    <th>COL2</th>
    <th>COL3</th>
  </tr>
  <tr>
    <td>10</td>
    <td>20</td>
    <td>NULL</td>
  </tr>
  <tr>
    <td>15</td>
    <td>NULL</td>
    <td>NULL</td>
  </tr>
  <tr>
    <td>50</td>
    <td>70</td>
    <td>20</td>
  </tr>
</table>

```SQL
1. SELECT SUM(COL2) FROM TAB1
-- 90

2. SELECT SUM(COL1 + COL2 + COL3) FROM TAB1
-- 140

3. SELECT SUM(COL2 + COL3) FROM TAB1
-- 90

4. SELECT SUM(COL2) + SUM(COL3) FROM TAB1
-- 110
```

pg66
#52
``` SQL
1.
SELECT COL1, SUM(COL2)
FROM T1
GROUP BY COL1
UNION ALL
SELECT NULL, SUM(COL2)
FROM T1
ORDER BY 1 ASC

SELECT COL1, SUM(COL2)
FROM T1
GROUP BY GROUPING SETS (COL1)
ORDER BY 1 ASC

SELECT COL1, SUM(COL2)
FROM T1
GROUP BY ROLLUP(COL1)
ORDER BY 1 ASC

SELECT COL1, SUM(COL2)
FROM T1
GROUP BY CUBE(COL1)
ORDER BY 1 ASC
```

pg68
#55
```SQL
SELECT A.서비스ID, B.서비스명, B.서비스URI
FROM (
    SELECT 서비스ID
    FROM 서비스
    INTERSECT
    SELECT 서비스ID
    FROM 서비스이용
) A
JOIN 서비스 B ON A.서비스ID = B.서비스ID;


-- 1
SELECT B.서비스ID, A.서비스명, A.서비스URL
FROM 서비스 A, 서비스이용 B
WHERE A.서비스ID = B.서비스ID

-- 2
SELECT X.서비스ID, X.서비스명, X.서비스URL
FROM 서비스 X
WHERE NOT EXISTS (
    SELECT 1
    FROM (
        SELECT 서비스ID
        FROM 서비스
        MINUS
        SELECT 서비스ID
        FROM 서비스이용
    ) Y
    WHERE X.서비스ID = Y.서비스ID
);

-- 3
SELECT B.서비스ID, A.서비스명, A.서비스URL
FROM 서비스 A LEFT OUTER JOIN 서비스이용 B
ON (A.서비스ID = B.서비스ID)
WHERE B.서비스ID IS NULL
GROUP BY B.서비스ID, A.서비스명, A.서비스URL;

-- 4
SELECT A.서비스ID, A.서비스명, A.서비스URL
FROM 서비스 A
WHERE 서비스ID IN (
    SELECT 서비스ID
    FROM 서비스이용
    MINUS
    SELECT 서비스ID
    FROM 서비스
);

```

pg70
#57
```SQL
SELECT B.GRADE, A.JOB, SUM(A.SAL) AS SUM_SAL, COUNT(*) AS CNT
FROM EMP A, SALGRADE B
WHERE A.SAL BETWEEN B.LOSAL AND B.HISAL
GROUP BY -- --

-- 1
GROUPING SETS(GRADE, (JOB, GRADE))

-- 2
ROLLUP (GRADE, JOB)

-- 3
GRADE, ROLLUP(JOB)

-- 4
GRADE, CUBE(JOB)
```

pg71
#58
```SQL
-- 1
SELECT
    A.부서코드,
    A.사원번호,
    A.급여,
    ROUND(RATIO_TO_REPORT(급여) OVER (PARTITION BY 부서코드), 2) AS 급여비중
FROM (
    SELECT
        사원번호,
        이름,
        부서코드,
        급여,
        SUM(급여) OVER (PARTITION BY 부서코드) AS 부서급합
    FROM 직원
    WHERE 부서코드 IN ('MKT', 'HRD')
) A
ORDER BY A.부서코드, A.급여 DESC, A.사원번호;

-- 2
SELECT
    A.부서코드,
    A.사원번호,
    A.급여,
    ROUND(급여/부서급여합, 2) AS 급여비중
FROM (
    SELECT
        사원번호,
        이름,
        부서코드,
        급여,
        SUM(급여) OVER (PARTITION BY 부서코드) AS 부서급합
    FROM 직원
    WHERE 부서코드 IN ('MKT', 'HRD')
) A
ORDER BY A.부서코드, A.급여 DESC, A.사원번호;

-- 3
SELECT
    A.부서코드,
    A.사원번호,
    A.급여,
    ROUND(급여/부서급여합, 2) AS 급여비중
FROM 직원 A,
(
    SELECT 부서코드, SUM(급여) AS 부서급합
    FROM 직원
    WHERE 부서코드 IN ('MKT', 'HRD')
    GROUP BY 부서코드
) B
WHERE A.부서코드 = B.부서코드
AND A.부서코드 IN ('MKT', 'HRD')
ORDER BY A.부서코드, A.급여 DESC, A.사원번호;


-- 4
SELECT
    A.부서코드,
    A.사원번호,
    A.급여,
    ROUND(급여/부서급여합, 2) AS 급여비중
FROM (
    SELECT
        사원번호,
        이름,
        부서코드,
        급여,
        SUM(급여) OVER (PARTITION BY 부서코드 ORDER BY 사원번호) AS 부서급여합
    FROM 직원
    WHERE 부서코드 IN ('MKT', 'HRD')
) A
ORDER BY A.부서코드, A.급여 DESC, A.사원번호;
```


pg73
#60

```SQL
SELECT C3
FROM TAB1
START WITH C2 IS NULL
CONNECT BY PRIOR C1 = C2
ORDER SIBLINGS BY C3 DESC
```

pg75~76
#64
```SQL
-- 1
SELECT
    A.부서코드,
    A.부서명,
    A.상위부서코드,
    B.매출액,
    LVL
FROM (
    SELECT
        부서코드,
        부서명,
        상위부서코드,
        LEVEL AS LVL
    FROM 부서
    START WITH 부서코드='120'
    CONNECT BY PRIOR 상위부서코드 = 부서코드
    UNION
    SELECT
        부서코드,
        부서명,
        상위부서코드,
        LEVEL AS LVL
    FROM 부서
    START WITH 부서코드 = '120'
    CONNECT BY 상위부서코드 = PRIOR 부서코드
) A
LEFT OUTER JOIN 매출 B
ON (A.부서코드 = B.부서코드)
ORDER BY A.부서코드;

-- 2
SELECT
    A.부서코드,
    A.부서명,
    A.상위부서코드,
    B.매출액,
    LVL
FROM (
    SELECT
        부서코드,
        부서명,
        상위부서코드,
        LEVEL AS LVL
    FROM 부서
    START WITH 부서코드='100'
    CONNECT BY PRIOR 상위부서코드 = 부서코드
) A
LEFT OUTER JOIN 매출 B
ON (A.부서코드 = B.부서코드)
ORDER BY A.부서코드;

-- 3
SELECT
    A.부서코드,
    A.부서명,
    A.상위부서코드,
    B.매출액,
    LVL
FROM (
    SELECT
        부서코드,
        부서명,
        상위부서코드,
        LEVEL AS LVL
    FROM 부서
    START WITH 부서코드='121'
    CONNECT BY PRIOR 상위부서코드 = 부서코드
) A
LEFT OUTER JOIN 매출 B
ON (A.부서코드 = B.부서코드)
ORDER BY A.부서코드

-- 4
SELECT
    A.부서코드,
    A.부서명,
    A.상위부서코드,
    B.매출액,
    LVL
FROM (
    SELECT
        부서코드,
        부서명,
        상위부서코드,
        LEVEL AS LVL
    FROM 부서
    START WITH 부서코드 = (
        SELECT 부서코드
        FROM 부서
        WHERE 상위부서코드 IS NULL
        START WITH 부서코드 = '120'
        CONNECT BY PRIOR 상위부서코드 = 부서코드
    )
    CONNECT BY PRIOR 부서코드 = 상위부서코드
) A
LEFT OUTER JOIN 매출 B
ON (A.부서코드 = B.부서코드)
ORDER BY A.부서코드;
```

```SQL
-- 1
SELECT
    KEY,
    PERCENT_RANK() OVER (
        PARTITION BY GRP
        ORDER BY VAL1
    ) AS VAL1,
    DENSE_RANK() OVER (ORDER BY VAL2) AS VAL2
FROM TBL
ORDER BY KEY;

-- 2
SELECT
    KEY,
    CUME_DIST() OVER (ORDER BY VAL1) AS VAL1,
    RANK() OVER (ORDER BY VAL2) AS VAL2
FROM TBL
ORDER BY KEY;

-- 3
SELECT
    KEY,
    PERCENT_RANK() OVER (
        PARTITION BY GRP
        ORDER BY VAL1
    ) AS VAL1,
    RANK() OVER (ORDER BY VAL2) AS VAL2
FROM TBL
ORDER BY KEY;

--4
SELECT
	KEY,
	RATIO_TO_REPORT(VAL1) OVER (PARTITION BY GRP) AS VAL1,
	NTILE(5) OVER (ORDER BY VAL2) AS VAL2
FROM TBL
ORDER BY KEY
```

pg84
#71
```SQL
SELECT A.회원ID, A.회원명, A.이메일
FROM 회원 A
WHERE EXISTS (
    SELECT 'X'
    FROM 이벤트 B, 메일발송 C
    WHERE B.시작일자 >= '2014.10.01'
    AND B.이벤트ID = C.이벤트ID
    AND A.회원ID = C.회원ID
    HAVING COUNT(*) < (
        SELECT COUNT(*)
        FROM 이벤트
        WHERE 시작일자 >= '2014.10.01'
    )
);
```

pg 86
#74 
```SQL
-- 1
SELECT 
    B.상품ID, 
    B.상품명, 
    C.평가항목ID, 
    C.평가항목명, 
    A.평가회차, 
    A.평가등급, 
    A.평가일자
FROM 
    평가결과 A, 
    평가대상상품 B, 
    품질평가항목 C, 
    (
        SELECT MAX(평가회차) as 평가회차 
        FROM 평가결과
    ) D
WHERE 
    A.상품ID = B.상품ID
    AND A.평가항목ID = C.평가항목ID
    AND A.평가회차 = D.평가회차;

-- 2
SELECT 
    B.상품ID, 
    B.상품명, 
    C.평가항목ID, 
    C.평가항목명, 
    A.평가회차, 
    A.평가등급, 
    A.평가일자
FROM 
    평가결과 A, 
    평가대상상품 B, 
    품질평가항목 C
WHERE 
    A.상품ID = B.상품ID
    AND A.평가항목ID = C.평가항목ID
    AND A.평가회차 = (
        SELECT MAX(X.평가회차) 
        FROM 평가결과 X 
        WHERE X.상품ID = B.상품ID AND X.평가항목ID = C.평가항목ID
    );

-- 3
SELECT 
    B.상품ID, 
    B.상품명, 
    C.평가항목ID, 
    C.평가항목명, 
    MAX(A.평가회차) AS 평가회차,
    MAX(A.평가등급) AS 평가등급,
    MAX(A.평가일자) AS 평가일자,
FROM
    평가결과 A,
    평가대상상품 B,
    품질평가항목 C,
    (
        SELECT MAX(평가회차) as 평가회차
        FROM 평가결과
    ) D
WHERE
    A.상품ID = B.상품ID
    AND A.평가항목ID = C.평가항목ID
    AND A.평가회차 = D.평가회차;

-- 4
SELECT 
    B.상품ID, 
    B.상품명, 
    C.평가항목ID, 
    C.평가항목명, 
    A.평가회차, 
    A.평가등급, 
    A.평가일자
FROM
    (
        SELECT
            상품ID,
            평가항목ID,
            MAX(평가회차) AS 평가회차,
            MAX(평가등급) AS 평가등급,
            MAX(평가일자) AS 평가일자
        FROM
            평가결과
        GROUP BY 
            상품ID, 
            평가항목ID
    ) A,
    평가대상상품 B,
    품질평가항목 C
WHERE 
    A.상품ID = B.상품ID
    AND A.평가항목ID = C.평가항목ID;
```